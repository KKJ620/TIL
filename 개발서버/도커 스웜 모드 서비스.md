### 도커 스웜 모드 서비스

------

기본적 도커 명령어의 제어 단위는 '컨테이너'

그러나 스웜 모드에서 제어하는 단위는 컨테이너가 아닌 서비스(Service)

서비스 : 같은 이미지에서 생성된 컨테이너의 집합

서비스를 제어하면 해당 서비스 내의 컨테이너에 같은 명령이 수행됨.

서비스 내의 컨테이너는 1개 이상 존재할 수 있으며, 컨테이너들은 각 워커 노드와 매니저 노드에 할당되며 이 컨테이너들을 태스크(Task)라고 함. 

예: ubuntu:14.04 이미지로 서비스를 생성하고 컨테이너의 수를 3개로 설정했다고 가정

스웜 스케줄러는 서비스의 정의에 따라 컨테이너를 할당할 적합한 노드를 선정하고, 해당 노드에 컨테이너를 분산해서 할당함. 반드시 각 노드에 하나씩 할당되지 않을 수도 있음.

이처럼 함께 생성된 컨테이너를 레플리카(replica)라고 하며, 서비스에 설정된 레플리카의 수만큼의 컨테이너가 스웜 클러스터 내에 존재해야 함.

스웜은 서비스의 컨테이너들에 대한 상태를 계속 확인하고 있다가 서비스 내에 정의된 레플리카의 수만큼 컨테이너가 스웜 클러스터에 존재하지 않으면 새로운 컨테이너 레플리카를 생성함. 컨테이너가 할당된 노드가 다운되면 매니저는 사용 가능한 다른 노드에 같은 컨테이너를 생성함. 서버가 다운되지 않고 멈추기만 하더라도 스웜 매니저는 새로운 컨테이너를 클러스터에 새롭게 생성한다. 

![Kubernetes Pod Replica](https://blog.kakaocdn.net/dn/PVyKa/btqxTKX0Xhc/KX9ByexdMoKWbKL6zsl1p1/img.png)

위 쿠버네티스처럼 작동함.

